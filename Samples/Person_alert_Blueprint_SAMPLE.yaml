# Here is a way to push a persistant notification to your screen
#   that will sit for a short time.  It is taylored to be part of
#   my Person Alert BP but with slight tweaking it could be used
#   for a lot of things. 


# Add to 'enter_action' and/or the 'leave_action' inputs:  (YAML Mode)
enter_action:
- service: script.personalert
  data:
    people: '{{ trigger.to_state.attributes.friendly_name }}'
    place: '{{ trigger.zone.attributes.friendly_name }}'
    trigg: '{{ trigger.id }}'
    notify_id: '{{ trigger.to_state.context.id }}'
leave_action:
- service: script.personalert
  data:
    people: '{{ trigger.to_state.attributes.friendly_name }}'
    place: '{{ trigger.zone.attributes.friendly_name }}'
    trigg: '{{ trigger.id }}'
    notify_id: '{{ trigger.to_state.context.id }}'


# Script bring called
script:
  personalert:
    alias: Person alert BP timed persistant_notification
    sequence:
    - alias: Notify interested parties WITH notification_id
      service: persistent_notification.create
      data:
        title: '{{ people + '' Status'' }}'
        message: '{{ ''Regarding: '' + people + ''\n'' + flip + '' '' + place +
        ''\n\nNotification_id:'' + notify_id }} '
        notification_id: '{{ notify_id }}'
    - alias: Add a delay so notification stays up a while
        # Pick your own delay time.  If you set it to 0 this script does nothing.
      delay:
        seconds: 37
    - alias: Kill the notification
      service: persistent_notification.dismiss
      data:
        notification_id: '{{ notify_id }}'
    variables:
        # Collect variable data and provide defaults
      people: placeholder1
      place: placeholder2
      trigg: enter_trigger
      notify_id: cd08c61d-0b69-4e01-a1f2-5c26746c99ae
      flip: '{% if trigg == ''enter_trigger'' %} They are located at: {% else %}
        They have left: {% endif %} '
    mode: queued
    icon: mdi:message-alert-outline
    max: 10
